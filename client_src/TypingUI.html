<html>
<head>
	<meta charset="utf-8">
	<title>Translation UI</title>
	<script type="text/javascript" src="js/d3.js"></script>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/underscore.js"></script>
	<script type="text/javascript" src="js/backbone.js"></script>
	<script type="text/javascript" src="js/ElphabaModel.js"></script>
	<script type="text/javascript" src="js/TypingState.js"></script>
	<script type="text/javascript" src="js/TypingModel.js"></script>
	<script type="text/javascript" src="js/TypingUI.js"></script>

<style type="text/css">
div.container {
	display: inline-block;
	vertical-align: top;
	margin: 10px;
	padding: 10px;
	border: 1px solid #999;

	font-family: Gill Sans;
	font-size: 10pt;
	color: #666;
	box-shadow: 2px 2px 15px #ccc;
	background: #eee;
}
</style>
<script type="text/javascript">
$(document).ready( function() {
	typingState = new TypingState();
	typingModel = new TypingModel({ "state" : typingState });
	typingUI = new TypingUI({ "model" : typingModel });
	
	var showSpanElements = function() { d3.select( ".GetSpanElements" ).text( typingModel.getAttr( "allSpanElements" ).map( function(d) { return "[" + d.text + "] " } ).join( " " ) ) };
	var userText = "Beim Letzteren kann es zu Verlusten beim Gedankengang , zu unzusammenhängenden Sätzen";
	var futureText = "und zu einer Inkohärenz kommen , die sich in schweren Fällen als Wortsalat äußert .";
	typingState.setUserText( userText );
	typingState.setFutureText( futureText );
	d3.select( ".SetUserText" ).text( userText ).on( "keyup", function() { typingState.setUserText( d3.event.srcElement.value ) } );
	d3.select( ".SetSuggestions" ).on( "keyup", function() { typingState.setSuggestions( d3.event.srcElement.value ) } );
	d3.select( ".SetFutureText" ).text( futureText ).on( "keyup", function() { typingState.setFutureText( d3.event.srcElement.value ) } );
	d3.select( ".SetCaretIndex" ).on( "change", function() { typingState.setCaretIndex( parseInt(d3.event.srcElement.value) ) } );
	d3.select( ".SetSelectedStartIndex" ).on( "change", function() { typingState.setSelectedIndexes( parseInt(d3.select(".SetSelectedStartIndex")[0][0].value), parseInt(d3.select(".SetSelectedEndIndex")[0][0].value) ) } );
	d3.select( ".SetSelectedEndIndex" ).on( "change", function() { typingState.setSelectedIndexes( parseInt(d3.select(".SetSelectedStartIndex")[0][0].value), parseInt(d3.select(".SetSelectedEndIndex")[0][0].value) ) } );
	d3.select( ".SetDebugLayout" ).on( "change", function() { typingUI.DEBUG = d3.select(".SetDebugLayout")[0][0].checked; typingUI.render() })
	typingModel.on( "modified", showSpanElements );
	showSpanElements();
});
</script>
</head>
<body>
	<div class="TypingUI container"></div><br/>
	<div class="container" style="padding-right: 30px">
		<p>
			<span style="display: inline-block; width: 100px; padding-right: 5px; text-align: right; vertical-align: top">User Text: </span>
			<textarea class="SetUserText" style="width: 400px; height: 80px"></textarea>
		</p>
		<p>
			<span style="display: inline-block; width: 100px; padding-right: 5px; text-align: right; vertical-align: top">Suggestions: </span>
			<textarea class="SetSuggestions" style="width: 400px; height: 80px"></textarea>
		</p>
		<p>
			<span style="display: inline-block; width: 100px; padding-right: 5px; text-align: right; vertical-align: top">Future Text: </span>
			<textarea class="SetFutureText" style="width: 400px; height: 80px"></textarea>
		</p>
		<p>
			<span style="display: inline-block; width: 100px; padding-right: 5px; text-align: right; vertical-align: top">Caret: </span>
			<input type="range" class="SetCaretIndex" style="width: 400px" value="0" min="0" max="250"/>
		</p>
		<p>
			<span style="display: inline-block; width: 100px; padding-right: 5px; text-align: right; vertical-align: top">Selection Start: </span>
			<input type="range" class="SetSelectedStartIndex" style="width: 400px" value="0" min="0" max="250"/><br/>
		</p>
		<p>
			<span style="display: inline-block; width: 100px; padding-right: 5px; text-align: right; vertical-align: top">Selection End: </span>
			<input type="range" class="SetSelectedEndIndex" style="width: 400px" value="0" min="0" max="250"/>
		</p>
		<p>
			<span style="display: inline-block; width: 100px; padding-right: 5px; text-align: right; vertical-align: top">Span Elements: </span>
			<textarea class="GetSpanElements" style="width: 400px; height: 120px; background: #eee" readonly></textarea>
		</p>
	</div><br/>
	<div class="container" style="padding-right: 30px">
		<p>
			<span style="display: inline-block; width: 100px; padding-right: 5px; text-align: right; vertical-align: top">Debug Mode: </span>
			<input type="checkbox" class="SetDebugLayout" style="width: 20px" /><span style="display: inline-block; width: 380px">Display non-overlapping HTML elements</span>
		</p>
	</div>
</body>
</html>
