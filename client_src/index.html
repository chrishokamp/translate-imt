<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
    <title>Translate UI</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<script type="text/javascript" src="js/d3.js"></script>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/underscore.js"></script>
	<script type="text/javascript" src="js/backbone.js"></script>
	<script type="text/javascript" src="js/chai.js"></script>
	<script type="text/javascript" src="js/TypingState.js"></script>
	<script type="text/javascript" src="js/TypingModel.js"></script>
	<script type="text/javascript" src="js/TypingUI.js"></script>
	<script type="text/javascript" src="js/TranslateServer.js"></script>

<script type="text/javascript">
var typingState, typingModel, typingUI;

var initTranslation = function() {
	var sourceText = $('#src-input').val();
	server.translate( function( translation ) { typingState.updateTranslation( translation ) }, sourceText );
}
var onSyncTranslation = function( syncKey ) {
	var sourceText = $('#src-input').val();
	var targetPrefix = typingState.getUserText();
	server.translate( function( translation ) { typingState.syncTranslation( syncKey, translation ) }, sourceText, targetPrefix );
};
$(document).ready( function() {
	typingState = new TypingState();
	typingModel = new TypingModel({ "state" : typingState });
	typingUI = new TypingUI({ "model" : typingModel });
	server = new TranslateServer();
	server.SERVER_URL = "http://localhost:8888/cgi-bin/redirect.py"

	typingState.on( "syncTranslation", onSyncTranslation );
	d3.select( "#src-input" ).on( "change", initTranslation );
});
</script>
</head>

<body>

<div id="source">
Source (enter text, then tab to target box):
<br>
<textarea cols="60" rows="10" id="src-input"></textarea>
</div>

<br>

Target (updates retrieved on space key):
<br>
<div id="textbox">
<form action="" name="form-tgt-input" id="form-tgt-input">
<textarea cols="60" rows="10" id="tgt-input" disabled style="background: #eee"></textarea>
</form>
</div>

<br>

<div class="TypingUI"></div><br/>

<div id="output"></div>

</body>
</html>
